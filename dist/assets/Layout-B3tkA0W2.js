import{c as y,r as i,m as He,j as e,n as We,o as G,x as Q,P as I,p as M,q as Z,y as $e,z as qe,D as Ge,L as Be,k as l,X as ie,l as z,d as le,u as ce,M as de,T as Ve,N as P,O as L,Q as O,S as D,s as ue,U as oe}from"./index-Dm7atRpY.js";import{h as Ye,R as Qe,u as Ze,F as Ke,B as N}from"./index-BlhDO3pI.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=y("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=y("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=y("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=y("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=y("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=y("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=y("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=y("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=y("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=y("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=y("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=y("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var H="Dialog",[ge,Rt]=We(H),[st,j]=ge(H),ye=a=>{const{__scopeDialog:n,children:s,open:r,defaultOpen:t,onOpenChange:o,modal:c=!0}=a,u=i.useRef(null),g=i.useRef(null),[x,d]=He({prop:r,defaultProp:t??!1,onChange:o,caller:H});return e.jsx(st,{scope:n,triggerRef:u,contentRef:g,contentId:G(),titleId:G(),descriptionId:G(),open:x,onOpenChange:d,onOpenToggle:i.useCallback(()=>d(b=>!b),[d]),modal:c,children:s})};ye.displayName=H;var ve="DialogTrigger",je=i.forwardRef((a,n)=>{const{__scopeDialog:s,...r}=a,t=j(ve,s),o=Q(n,t.triggerRef);return e.jsx(I.button,{type:"button","aria-haspopup":"dialog","aria-expanded":t.open,"aria-controls":t.contentId,"data-state":J(t.open),...r,ref:o,onClick:M(a.onClick,t.onOpenToggle)})});je.displayName=ve;var K="DialogPortal",[nt,we]=ge(K,{forceMount:void 0}),be=a=>{const{__scopeDialog:n,forceMount:s,children:r,container:t}=a,o=j(K,n);return e.jsx(nt,{scope:n,forceMount:s,children:i.Children.map(r,c=>e.jsx(Z,{present:s||o.open,children:e.jsx($e,{asChild:!0,container:t,children:c})}))})};be.displayName=K;var _="DialogOverlay",Ne=i.forwardRef((a,n)=>{const s=we(_,a.__scopeDialog),{forceMount:r=s.forceMount,...t}=a,o=j(_,a.__scopeDialog);return o.modal?e.jsx(Z,{present:r||o.open,children:e.jsx(ot,{...t,ref:n})}):null});Ne.displayName=_;var rt=qe("DialogOverlay.RemoveScroll"),ot=i.forwardRef((a,n)=>{const{__scopeDialog:s,...r}=a,t=j(_,s);return e.jsx(Qe,{as:rt,allowPinchZoom:!0,shards:[t.contentRef],children:e.jsx(I.div,{"data-state":J(t.open),...r,ref:n,style:{pointerEvents:"auto",...r.style}})})}),k="DialogContent",ke=i.forwardRef((a,n)=>{const s=we(k,a.__scopeDialog),{forceMount:r=s.forceMount,...t}=a,o=j(k,a.__scopeDialog);return e.jsx(Z,{present:r||o.open,children:o.modal?e.jsx(it,{...t,ref:n}):e.jsx(lt,{...t,ref:n})})});ke.displayName=k;var it=i.forwardRef((a,n)=>{const s=j(k,a.__scopeDialog),r=i.useRef(null),t=Q(n,s.contentRef,r);return i.useEffect(()=>{const o=r.current;if(o)return Ye(o)},[]),e.jsx(Ce,{...a,ref:t,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:M(a.onCloseAutoFocus,o=>{o.preventDefault(),s.triggerRef.current?.focus()}),onPointerDownOutside:M(a.onPointerDownOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&o.preventDefault()}),onFocusOutside:M(a.onFocusOutside,o=>o.preventDefault())})}),lt=i.forwardRef((a,n)=>{const s=j(k,a.__scopeDialog),r=i.useRef(!1),t=i.useRef(!1);return e.jsx(Ce,{...a,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{a.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||s.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,t.current=!1},onInteractOutside:o=>{a.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(t.current=!0));const c=o.target;s.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&t.current&&o.preventDefault()}})}),Ce=i.forwardRef((a,n)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:t,onCloseAutoFocus:o,...c}=a,u=j(k,s),g=i.useRef(null),x=Q(n,g);return Ze(),e.jsxs(e.Fragment,{children:[e.jsx(Ke,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:t,onUnmountAutoFocus:o,children:e.jsx(Ge,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":J(u.open),...c,ref:x,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(ct,{titleId:u.titleId}),e.jsx(ut,{contentRef:g,descriptionId:u.descriptionId})]})]})}),X="DialogTitle",De=i.forwardRef((a,n)=>{const{__scopeDialog:s,...r}=a,t=j(X,s);return e.jsx(I.h2,{id:t.titleId,...r,ref:n})});De.displayName=X;var Re="DialogDescription",Me=i.forwardRef((a,n)=>{const{__scopeDialog:s,...r}=a,t=j(Re,s);return e.jsx(I.p,{id:t.descriptionId,...r,ref:n})});Me.displayName=Re;var Ie="DialogClose",Ae=i.forwardRef((a,n)=>{const{__scopeDialog:s,...r}=a,t=j(Ie,s);return e.jsx(I.button,{type:"button",...r,ref:n,onClick:M(a.onClick,()=>t.onOpenChange(!1))})});Ae.displayName=Ie;function J(a){return a?"open":"closed"}var Ee="DialogTitleWarning",[Mt,Se]=Be(Ee,{contentName:k,titleName:X,docsSlug:"dialog"}),ct=({titleId:a})=>{const n=Se(Ee),s=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return i.useEffect(()=>{a&&(document.getElementById(a)||console.error(s))},[s,a]),null},dt="DialogDescriptionWarning",ut=({contentRef:a,descriptionId:n})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Se(dt).contentName}}.`;return i.useEffect(()=>{const t=a.current?.getAttribute("aria-describedby");n&&t&&(document.getElementById(n)||console.warn(r))},[r,a,n]),null},ht=ye,ft=je,mt=be,Pe=Ne,Le=ke,Oe=De,Te=Me,xt=Ae;const _e=ht,It=ft,pt=mt,Ue=i.forwardRef(({className:a,...n},s)=>e.jsx(Pe,{ref:s,className:l("fixed inset-0 z-[100] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n}));Ue.displayName=Pe.displayName;const ee=i.forwardRef(({className:a,children:n,...s},r)=>e.jsxs(pt,{children:[e.jsx(Ue,{}),e.jsxs(Le,{ref:r,className:l("fixed left-[50%] top-[50%] z-[101] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[n,e.jsxs(xt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ee.displayName=Le.displayName;const te=({className:a,...n})=>e.jsx("div",{className:l("flex flex-col space-y-1.5 text-center sm:text-left",a),...n});te.displayName="DialogHeader";const ae=({className:a,...n})=>e.jsx("div",{className:l("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...n});ae.displayName="DialogFooter";const se=i.forwardRef(({className:a,...n},s)=>e.jsx(Oe,{ref:s,className:l("text-lg font-semibold leading-none tracking-tight",a),...n}));se.displayName=Oe.displayName;const ne=i.forwardRef(({className:a,...n},s)=>e.jsx(Te,{ref:s,className:l("text-sm text-muted-foreground",a),...n}));ne.displayName=Te.displayName;function Fe(a){const[n,s]=i.useState(()=>typeof window<"u"?window.matchMedia(a).matches:!1);return i.useEffect(()=>{const r=window.matchMedia(a);s(r.matches);const t=o=>{s(o.matches)};return r.addEventListener?r.addEventListener("change",t):r.addListener(t),()=>{r.removeEventListener?r.removeEventListener("change",t):r.removeListener(t)}},[a]),n}const gt=()=>{try{return localStorage.getItem("userRole")}catch{return null}},yt=()=>{try{return localStorage.getItem("userId")}catch{return null}},U=(a,n)=>{try{localStorage.setItem("userRole",a),localStorage.setItem("userId",n)}catch{}},F=()=>{try{localStorage.removeItem("userRole"),localStorage.removeItem("userId")}catch{}};let v=gt(),w=yt();const ze=(a="")=>[{icon:me,label:"Dashboard",href:"/"},{icon:xe,label:"Take Attendance",href:"/take-attendance",isActive:n=>n==="/take-attendance"||n.startsWith("/take-attendance/")},{icon:he,label:"Schedule",href:"/schedule",isActive:n=>n==="/schedule"||n.startsWith("/sessions/")},{icon:pe,label:"Students",href:"/students"},{icon:fe,label:"Records",href:"/records"},{icon:et,label:"Excuse Application",href:"/excuse-application",isActive:n=>n==="/excuse-application"},{icon:Xe,label:"Academic Year",href:"/academic-year"},...a==="admin"?[{icon:at,label:"Accounts",href:"/accounts"}]:[]],vt=()=>{const a=z(),n=le(),{user:s,signOut:r}=ce(),{isCollapsed:t,toggleSidebar:o}=de(),[c,u]=i.useState(()=>v||"user"),[g,x]=i.useState(!1),[d,b]=i.useState(!1),W=i.useRef(!0),re=ze(c);i.useEffect(()=>{const f=async()=>{if(v&&w===s?.id){u(v);return}if(!s){const h="user";u(h),v=h,w=null,F();return}try{const{data:h,error:m}=await ue.from("profiles").select("role").eq("id",s.id).single();if(m)throw m;const p=h.role||"user";u(p),v=p,w=s.id,U(p,s.id)}catch(h){console.error("Error fetching user role:",h);const m="user";u(m),v=m,w=s?.id||null,s?.id?U(m,s.id):F()}};(W.current||w!==s?.id)&&(f(),W.current=!1)},[s?.id]);const A=()=>{switch(c){case"admin":return"Admin Panel";case"instructor":return"Instructor Panel";default:return"User Panel"}},$=async()=>{try{await r(),n("/login")}catch(f){console.error("Error signing out:",f)}},E=()=>{x(!0)},q=async()=>{x(!1),await $()},S=()=>{t?o():(b(!0),setTimeout(()=>{o(),setTimeout(()=>b(!1),300)},50))};return e.jsx(Ve,{delayDuration:0,children:e.jsxs("div",{className:l("h-full flex flex-col bg-background border-r border-sidebar-border","transition-[width] duration-250 ease-in-out",t?"w-12":"w-64"),children:[e.jsxs("div",{className:l("flex-1",t?"px-2 pb-2":"p-4"),children:[e.jsxs("div",{className:l("flex items-center","transition-all duration-300 ease-in-out delay-200",t?"justify-center mb-0":"gap-3 mb-8"),children:[t?e.jsxs(P,{children:[e.jsx(L,{asChild:!0,children:e.jsx("div",{className:"bg-gradient-primary flex items-center justify-center cursor-pointer transition-all duration-200 hover:scale-105 w-8 h-8 rounded-md",onClick:S,children:e.jsx(T,{className:"w-6 h-6 text-primary-foreground"})})}),e.jsx(O,{side:"right",align:"center",children:"Expand sidebar"})]}):e.jsx("div",{className:"bg-gradient-primary flex items-center justify-center cursor-pointer transition-all duration-200 hover:scale-105 w-10 h-10 rounded-md",onClick:S,children:e.jsx(T,{className:"w-7 h-7 text-primary-foreground"})}),e.jsx("div",{className:l("flex-1 flex items-center overflow-hidden",d?"transition-opacity duration-75":"transition-all duration-300 ease-in-out delay-250",t||d?"opacity-0 translate-x-2 w-0":"opacity-100 translate-x-0"),children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg font-bold text-education-navy whitespace-nowrap",children:"AMSUIP"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:A()})]})})]}),e.jsxs("div",{className:l(t?"space-y-2 mb-0 mt-0":"space-y-1.5 mb-0"),children:[!t&&e.jsx("div",{className:l("transition-all duration-300 ease-in-out delay-200","px-3 pb-0"),children:e.jsx("span",{className:l("font-medium text-muted-foreground/60 uppercase tracking-wider block",d?"transition-opacity duration-75":"transition-all duration-300 ease-in-out delay-300","text-xs opacity-100 text-left"),children:"MENU"})}),re.filter(f=>f.href!=="/students"&&f.href!=="/academic-year"||c==="admin").map((f,h)=>{const m=f.isActive?f.isActive(a.pathname):a.pathname===f.href,p=f.icon,C=e.jsxs("div",{className:l("flex items-center cursor-pointer group relative","transition-all duration-300 ease-in-out",t?"h-8 justify-center w-6 mx-auto p-0 rounded-sm":"h-9 justify-start gap-3 px-3 w-full rounded-sm",m?t?"bg-gradient-primary shadow-glow text-white h-6 w-6 mx-auto rounded-sm":"bg-gradient-primary shadow-glow text-white":"hover:bg-sidebar-accent/50 hover:text-foreground"),style:{transitionDelay:t?`${250+h*30}ms`:"0ms"},children:[e.jsx(p,{className:l("flex-shrink-0","w-4 h-4")}),e.jsx("span",{className:l("font-medium whitespace-nowrap min-w-0",d?"transition-opacity duration-75":"transition-all duration-250 ease-in-out delay-300",t||d?"opacity-0 translate-x-2 w-0 overflow-hidden text-xs":"opacity-100 translate-x-0 flex-1 text-sm"),children:f.label})]});return e.jsx(D,{to:f.href,className:"block",children:t?e.jsxs(P,{children:[e.jsx(L,{asChild:!0,children:C}),e.jsx(O,{side:"right",align:"center",children:f.label})]}):C},f.href)})]}),e.jsxs("div",{className:l("mt-0",t?"space-y-1":"space-y-1.5"),children:[!t&&e.jsx("div",{className:l("transition-all duration-300 ease-in-out delay-200","px-3 py-0"),children:e.jsx("span",{className:l("font-medium text-muted-foreground/60 uppercase tracking-wider block",d?"transition-opacity duration-75":"transition-all duration-300 ease-in-out delay-300","text-xs opacity-100 text-left"),children:"OTHER"})}),e.jsx(D,{to:"/profile",className:"block",children:t?e.jsxs(P,{children:[e.jsx(L,{asChild:!0,children:e.jsxs("div",{className:l("flex items-center cursor-pointer group relative","transition-all duration-300 ease-in-out delay-400",t?"h-8 justify-center w-6 mx-auto p-0 rounded-sm":"h-9 justify-start gap-3 px-3 w-full rounded-sm",a.pathname==="/profile"?t?"bg-gradient-primary shadow-glow text-white h-6 w-6 mx-auto rounded-sm":"bg-gradient-primary shadow-glow text-white":"hover:bg-sidebar-accent/50 hover:text-foreground"),children:[e.jsx(Y,{className:l("flex-shrink-0","w-4 h-4")}),e.jsx("span",{className:l("font-medium whitespace-nowrap min-w-0",d?"transition-opacity duration-75":"transition-all duration-250 ease-in-out delay-450",t||d?"opacity-0 translate-x-2 w-0 overflow-hidden text-xs":"opacity-100 translate-x-0 flex-1 text-sm"),children:"Profile"})]})}),e.jsx(O,{side:"right",align:"center",children:"Profile"})]}):e.jsxs("div",{className:l("flex items-center cursor-pointer group relative","transition-all duration-300 ease-in-out delay-400",t?"h-8 justify-center w-6 mx-auto p-0 rounded-sm":"h-9 justify-start gap-3 px-3 w-full rounded-sm",a.pathname==="/profile"?t?"bg-gradient-primary shadow-glow text-white h-6 w-6 mx-auto rounded-sm":"bg-gradient-primary shadow-glow text-white":"hover:bg-sidebar-accent/50 hover:text-foreground"),children:[e.jsx(Y,{className:l("flex-shrink-0","w-4 h-4")}),e.jsx("span",{className:l("font-medium whitespace-nowrap min-w-0",d?"transition-opacity duration-75":"transition-all duration-250 ease-in-out delay-450",t||d?"opacity-0 translate-x-2 w-0 overflow-hidden text-xs":"opacity-100 translate-x-0 flex-1 text-sm"),children:"Profile"})]})}),t?e.jsxs(P,{children:[e.jsx(L,{asChild:!0,children:e.jsxs("div",{className:l("flex items-center cursor-pointer group relative","transition-all duration-300 ease-in-out delay-450",t?"h-8 justify-center w-6 mx-auto p-0 rounded-sm":"h-9 justify-start gap-3 px-3 w-full rounded-sm","hover:bg-destructive/10 hover:text-destructive text-destructive/90"),onClick:E,children:[e.jsx(V,{className:l("flex-shrink-0","w-4 h-4")}),e.jsx("span",{className:l("font-medium whitespace-nowrap min-w-0",d?"transition-opacity duration-75":"transition-all duration-250 ease-in-out delay-500",t||d?"opacity-0 translate-x-2 w-0 overflow-hidden text-xs":"opacity-100 translate-x-0 flex-1 text-sm"),children:"Log Out"})]})}),e.jsx(O,{side:"right",align:"center",children:"Log Out"})]}):e.jsxs("div",{className:l("flex items-center cursor-pointer group relative","transition-all duration-300 ease-in-out delay-450",t?"h-8 justify-center w-6 mx-auto p-0 rounded-sm":"h-9 justify-start gap-3 px-3 w-full rounded-sm","hover:bg-destructive/10 hover:text-destructive text-destructive/90"),onClick:E,children:[e.jsx(V,{className:l("flex-shrink-0","w-4 h-4")}),e.jsx("span",{className:l("font-medium whitespace-nowrap min-w-0",d?"transition-opacity duration-75":"transition-all duration-250 ease-in-out delay-500",t||d?"opacity-0 translate-x-2 w-0 overflow-hidden text-xs":"opacity-100 translate-x-0 flex-1 text-sm"),children:"Log Out"})]})]})]}),e.jsx(_e,{open:g,onOpenChange:x,children:e.jsxs(ee,{className:"!max-w-md w-[90vw] mx-auto rounded-lg",children:[e.jsxs(te,{children:[e.jsx(se,{children:"Confirm Logout"}),e.jsx(ne,{children:"Are you sure you want to log out? You will need to sign in again to access your account."})]}),e.jsxs(ae,{className:"!flex !flex-row !justify-end gap-2 sm:gap-3",children:[e.jsx(N,{variant:"outline",onClick:()=>x(!1),className:"flex-1 sm:flex-none sm:min-w-[80px]",children:"Cancel"}),e.jsx(N,{variant:"destructive",onClick:q,className:"flex-1 sm:flex-none sm:min-w-[80px]",children:"Log Out"})]})]})})]})})},jt=({isOpen:a,onClose:n})=>{const s=z(),r=le(),{user:t,signOut:o}=ce(),[c,u]=i.useState(()=>v||"user"),[g,x]=i.useState(!1),[d,b]=i.useState(!1),[W,re]=i.useState(!1),A=i.useRef(!0),$=ze(c);i.useEffect(()=>{if(a)b(!0);else{const h=setTimeout(()=>{b(!1)},300);return()=>clearTimeout(h)}},[a]),i.useEffect(()=>{const h=async()=>{if(v&&w===t?.id){u(v);return}if(!t){const m="user";u(m),v=m,w=null,F();return}try{const{data:m,error:p}=await ue.from("profiles").select("role").eq("id",t.id).single();if(p)throw p;const C=m.role||"user";u(C),v=C,w=t.id,U(C,t.id)}catch(m){console.error("Error fetching user role:",m);const p="user";u(p),v=p,w=t?.id||null,t?.id?U(p,t.id):F()}};(A.current||w!==t?.id)&&(h(),A.current=!1)},[t?.id]);const E=()=>{switch(c){case"admin":return"Admin Panel";case"instructor":return"Instructor Panel";default:return"User Panel"}},q=async()=>{try{await o(),r("/login")}catch(h){console.error("Error signing out:",h)}},S=()=>{x(!0)},f=async()=>{x(!1),await q()};return d?e.jsxs("div",{className:"fixed inset-0 z-[60] md:hidden",children:[e.jsx("div",{className:l("fixed inset-0 bg-black/50 transition-opacity duration-300 ease-in-out",a?"opacity-100":"opacity-0"),onClick:n}),e.jsxs("div",{className:l("fixed inset-y-0 left-0 w-64 bg-background p-6 overflow-y-auto",a?"animate-slide-in":"animate-slide-out"),style:{animationDuration:"300ms",animationTimingFunction:"ease-in-out",animationFillMode:"forwards"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-primary rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-education-navy",children:"AMSUIP"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:E()})]})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(ie,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"px-4 pt-2 pb-1",children:e.jsx("span",{className:"text-xs font-medium text-muted-foreground/60 uppercase tracking-wider",children:"MENU"})}),$.filter(h=>h.href!=="/students"&&h.href!=="/academic-year"||c==="admin").map(h=>{const m=h.isActive?h.isActive(s.pathname):s.pathname===h.href,p=h.icon;return e.jsx(D,{to:h.href,onClick:n,children:e.jsxs(N,{variant:"ghost",className:l("w-full justify-start gap-3 h-10 text-sm transition-all duration-200 group relative overflow-hidden",m?"bg-gradient-primary shadow-glow text-white":"hover:bg-[hsl(214,84%,56%)] hover:bg-opacity-10 hover:text-foreground"),children:[e.jsx(p,{className:"w-4.5 h-4.5"}),h.label]})},h.href)})]}),e.jsxs("div",{className:"mt-auto space-y-1",children:[e.jsx("div",{className:"px-3 py-1",children:e.jsx("span",{className:"text-xs font-medium text-muted-foreground/60 uppercase tracking-wider",children:"OTHER"})}),e.jsx(D,{to:"/profile",onClick:n,children:e.jsxs(N,{variant:"ghost",className:"w-full justify-start gap-3 h-10 text-sm transition-all duration-200 group relative overflow-hidden hover:bg-[hsl(214,84%,56%)] hover:bg-opacity-10 hover:text-foreground",style:{margin:"1px 0"},children:[e.jsx(Y,{className:"w-4.5 h-4.5"}),"Profile"]})}),e.jsxs(N,{variant:"ghost",className:"w-full justify-start gap-3 h-10 text-sm transition-all duration-200 group relative overflow-hidden hover:bg-destructive/10 hover:text-destructive text-destructive/90",style:{margin:"1px 0"},onClick:S,children:[e.jsx(V,{className:"w-4.5 h-4.5"}),"Log Out"]})]})]}),e.jsx(_e,{open:g,onOpenChange:x,children:e.jsxs(ee,{className:"!max-w-md w-[90vw] mx-auto rounded-lg",children:[e.jsxs(te,{children:[e.jsx(se,{children:"Confirm Logout"}),e.jsx(ne,{children:"Are you sure you want to log out? You will need to sign in again to access your account."})]}),e.jsxs(ae,{className:"!flex !flex-row !justify-end gap-2 sm:gap-3",children:[e.jsx(N,{variant:"outline",onClick:()=>x(!1),className:"flex-1 sm:flex-none sm:min-w-[80px]",children:"Cancel"}),e.jsx(N,{variant:"destructive",onClick:f,className:"flex-1 sm:flex-none sm:min-w-[80px]",children:"Log Out"})]})]})})]}):null},wt=()=>{const a=Fe("(min-width: 768px)"),[n,s]=i.useState(!1),r=()=>{s(!n)},t=()=>{s(!1)};return a?e.jsx("div",{className:"fixed left-0 top-0 h-full z-40",children:e.jsx(vt,{})}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"sticky top-0 z-50 md:hidden bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-sidebar-border px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-primary-foreground"})}),e.jsx("h1",{className:"text-lg font-bold text-education-navy",children:"AMSUIP"})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:r,children:e.jsx(tt,{className:"h-5 w-5"})})]})}),e.jsx(jt,{isOpen:n,onClose:t})]})},B={"/":"Dashboard","/attendance":"Attendance","/records":"Records","/students":"Students","/schedule":"Schedule","/take-attendance":"Take Attendance","/accounts":"Accounts","/excuse-application":"Excuse Application","/academic-year":"Academic Year","/profile":"Profile"},bt=[{pattern:"/sessions/:sessionId/students",label:()=>"Session Students"},{pattern:"/take-attendance/:sessionId",label:()=>"Take Attendance"}],Nt=()=>{const a=z(),s=(()=>{const r=a.pathname.split("/").filter(Boolean);if(r.length===0)return[{label:B["/"],href:"/"}];const t=[{label:B["/"],href:"/"}];let o="";for(let c=0;c<r.length;c++){o+=`/${r[c]}`;const u=B[o];if(u){t.push({label:u,href:o});continue}const g=bt.find(d=>oe({path:d.pattern,end:!1},o));if(g){const d=oe({path:g.pattern,end:!1},o),b=g.label(d?.params||{});t.push({label:b,href:o});continue}const x=r[c].replace(/-/g," ").replace(/\b\w/g,d=>d.toUpperCase());t.push({label:x,href:o})}return t})();return e.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-2",role:"navigation",children:e.jsx("ol",{className:"flex flex-wrap items-center gap-1 text-xs text-muted-foreground",children:s.map((r,t)=>{const o=t===s.length-1;return e.jsxs("li",{className:"flex items-center",children:[t>0&&e.jsx(Je,{className:"w-3 h-3 mx-1 text-muted-foreground/60","aria-hidden":"true"}),o?e.jsx("span",{"aria-current":"page",className:"font-medium text-foreground",children:r.label}):e.jsx(D,{to:r.href,className:"hover:text-foreground focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 rounded-sm px-0.5",children:r.label})]},r.href)})})})},kt=()=>{const a=z(),n=[{icon:me,label:"Dashboard",href:"/"},{icon:xe,label:"Attendance",href:"/take-attendance",isActive:s=>s==="/take-attendance"||s.startsWith("/take-attendance/")},{icon:pe,label:"Students",href:"/students"},{icon:he,label:"Schedule",href:"/schedule",isActive:s=>s==="/schedule"||s.startsWith("/sessions/")},{icon:fe,label:"Records",href:"/records"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border flex justify-around items-center h-16 z-30 md:hidden",children:n.map(s=>{const r=s.isActive?s.isActive(a.pathname):a.pathname===s.href,t=s.icon;return e.jsxs(D,{to:s.href,className:l("flex flex-col items-center justify-center w-full h-full text-xs",r?"text-primary":"text-muted-foreground hover:text-foreground"),children:[e.jsx(t,{className:"w-5 h-5 mb-1"}),e.jsx("span",{children:s.label})]},s.href)})})};function R({className:a,...n}){return e.jsx("div",{className:l("animate-pulse rounded-md bg-muted",a),...n})}const At=({children:a})=>{const n=Fe("(min-width: 768px)"),{isCollapsed:s}=de(),[r,t]=i.useState(!0);return i.useEffect(()=>{const o=setTimeout(()=>{t(!1)},50);return()=>clearTimeout(o)},[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("a",{href:"#main",className:"sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-primary text-primary-foreground px-3 py-1 rounded",children:"Skip to content"}),e.jsx(wt,{}),e.jsxs("main",{className:l("min-w-0","transition-[margin-left] duration-250 ease-in-out",n?s?"ml-12":"ml-64":"ml-0 w-full px-4","py-3 md:py-4"),children:[e.jsx("div",{className:"px-1 md:px-0",children:e.jsx(Nt,{})}),r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{className:"h-8 w-64"}),e.jsx(R,{className:"h-9 w-32"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((o,c)=>e.jsx(R,{className:"h-24 w-full"},c))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(R,{className:"h-64 w-full"}),e.jsx(R,{className:"h-64 w-full"})]})]}):e.jsx("div",{id:"main",role:"main","aria-live":"polite",children:a})]}),e.jsx(kt,{})]})};export{he as C,_e as D,fe as F,T as G,At as L,Pe as O,mt as P,ht as R,R as S,pe as U,It as a,ee as b,te as c,se as d,ne as e,Je as f,ae as g,Y as h,xe as i,Le as j};
